const fs = require('fs');
const http = require('http');

function copyFiles (fileFrom, fileTu){
    fs.stat(fileFrom, function(err, stats){
        let check = stats.isFile();
        if (check){
            console.log('File is Ok');
            fs.readFile(fileFrom, function(err, data){
                if(err){
                    console.error(err);
                }else{
                    // console.log(data); - buffer
                    copyFileS(fileFrom, fileTu);
                }
            });
        }
    })    
}

copyFileS = (paramFrom, paramTu) => {
    fs.copyFile(paramFrom, paramTu, (err) => {
        if (err) {
            console.error(err);
        } else {
            syncData(paramTu);
            console.log('Done. File is copied');
        }
    });
}

function copyContent (fileFrom, fileTu){
    fs.stat(fileFrom, function(err, stats){
        let check = stats.isFile();
        if (check){
            console.log('File is Ok');
            fs.readFile(fileFrom, function(err, data){
                if(err){
                    console.error(err);
                }else{                
                    console.log('Ok, we read File');
                        fs.writeFile(fileTu, data, (err) => {
                            if (err) {
                                console.error(err);
                            } else {

                                console.log('It\'s saved in New File!');
                            }
                        });
                }
            });
        } 
    })    
}

syncData = (dataImg) => {
    http.createServer(function(req, res){
    res.writeHead(200);
    let img = fs.readFileSync(dataImg);
    res.end(img, 'binary');
}).listen(1337, '127.0.0.1'); 
console.log('Server running at http://127.0.0.1:1337/. Use CTRL+C to exit end restart');
}


/* Copy File*/
module.exports.f1 = copyFiles;
/* Copy Content */
module.exports.f2 = copyContent;

